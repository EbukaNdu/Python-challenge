import csv

# File path to the CSV file
csv_file_path = r'\Users\nduag\OneDrive\Documents\data boot camp\python-challenge\PyBank resources'

def financial_analysis(csv_file):
    # determine variables to store data
    total_months = 0
    net_profit_losses = 0
    previous_profit_loss = None
    profit_changes = []

    # determine variables for greatest increase and decrease
    greatest_increase = {"date": None, "amount": float("-inf")}
    greatest_decrease = {"date": None, "amount": float("inf")}
    

    #Read the CSV file
    with open(csv_file, 'r') as file:
        reader = csv.DictReader(file) 
# Chatgpt thought me that using csv.dictreader simplifies the code by allowing direct access to csv data by column names
        
        #Loop through each row in the csv file
        #calculate the total months and add the net profit/losses to net total
        for row in reader:
            total_months += 1
            net_profit_losses += int(row['Profit/Losses'])
            
            # Track changes in profit/loss
            if previous_profit_loss is not None:
                profit_change = int(row['Profit/Losses']) - previous_profit_loss
                profit_changes.append(profit_change)
                
                # Check for greatest increase and decrease
                if profit_change > greatest_increase["amount"]:
                    greatest_increase["date"] = row['Date']
                    greatest_increase["amount"] = profit_change
                
                if profit_change < greatest_decrease["amount"]:
                    greatest_decrease["date"] = row['Date']
                    greatest_decrease["amount"] = profit_change

           # Update previous profit/loss for the next iteration 
            previous_profit_loss = int(row['Profit/Losses'])

    # Calculate average change
    average_change = sum(profit_changes) / len(profit_changes)
    
    # Print the financial analysis
    print("Financial Analysis")
    print("------------------")
    print(f"Total Months: {total_months}")
    print(f"Total: ${net_profit_losses}")
    print(f"Average Change: ${round(average_change, 2)}")
    print(f"Greatest Increase in Profits: {greatest_increase['date']} (${greatest_increase['amount']})")
    print(f"Greatest Decrease in Profits: {greatest_decrease['date']} (${greatest_decrease['amount']})")

# Call the function with the file path
financial_analysis(csv_file_path)

